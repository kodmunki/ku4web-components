import{r as t,c as i,h as s,H as h,g as e}from"./p-80e7f1ae.js";import{t as a,E as n,Z as r}from"./p-0163b029.js";const o=class{constructor(s){t(this,s),this.validated=i(this,"ku4ValidationValidated",7),this.pattern=".*",this.flags="",this.method="";const h=this.pattern.split(" "),e=this.flags.split(" "),n=this.method.trim();this.regex=h.map((t,i)=>new RegExp(t,e[i])),this.validationMethod=a.isNullOrEmpty(this.method)?()=>!0:new Function("value",/^return/.test(n)?n:"return "+n),this.handleInput=this.handleInput.bind(this),this.handleChange=this.handleChange.bind(this),this.handleBlur=this.handleBlur.bind(this),this.handleReset=this.handleReset.bind(this)}async validate(){return this.assert()}handleInput(){a.isFalse(this.isValid)&&this.assert()}handleChange(){a.isFalse(this.isValid)&&this.assert()}handleBlur(){this.assert()}handleReset(){this.isValid=!0,this.invalid=!this.isValid,this.input.setAttribute("aria-invalid",this.invalid)}assert(){const{ele:t,validOptions:i,input:s,regex:h}=this,e=this.isValid;var n,r,o,l;return this.isValid=(n=h,r=s.value,l=t,((o=i)?o.some(t=>t===r)&&n.every(t=>t.test(r)):l?l.value===r&&n.every(t=>t.test(r)):n.every(t=>t.test(r)))&&this.validationMethod(s.value)),this.invalid=!this.isValid,s.setAttribute("aria-invalid",this.invalid),a.isFalse(e)&&this.isValid&&this.validated.emit(this.isValid),this.isValid}componentWillLoad(){if(this.input=document.getElementById(this.for),a.exists(this.input)){this.ele=document.getElementById(this.element)||document.querySelector(this.element),this.validOptions=a.exists(this.values)?this.values.split(","):this.ele&&"DATALIST"===this.ele.nodeName&&[].slice.call(this.ele.querySelectorAll("option")).map(t=>t.value);const t=this.input.getAttribute("aria-describedby"),i=this.host.getAttribute("id")||n();this.host.setAttribute("id",i),a.isNullOrEmpty(t)&&this.input.setAttribute("aria-describedby",i),r(0).then(()=>{this.input.addEventListener("input",this.handleInput),this.input.addEventListener("change",this.handleChange),this.input.addEventListener("blur",this.handleBlur)}),a.isFunction(this.host.closest)&&(this.form=this.host.closest("form"),this.form&&this.form.addEventListener&&this.form.addEventListener("reset",this.handleReset))}else console.error("ku4-validation must have a `for` attribute pointing to a target field `id`.")}disconnectedCallback(){this.input&&this.input.removeEventListener&&(this.input.removeEventListener("input",this.handleInput),this.input.removeEventListener("change",this.handleChange),this.input.removeEventListener("blur",this.handleBlur)),this.form&&this.form.removeEventListener&&this.form.removeEventListener("reset",this.handleReset)}render(){return s(h,{role:"alert","aria-live":"assertive"},s("slot",null))}get host(){return e(this)}};o.style=":host{visibility:hidden !important}:host([invalid]){visibility:visible !important}";export{o as ku4_validation}