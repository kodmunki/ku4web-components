import{r as t,h as s,g as i}from"./p-80e7f1ae.js";import{u as h,Y as e,q as n}from"./p-1568c03c.js";const o=class{constructor(s){t(this,s),this.charIndexes=[],this.reverseCharIndexes=[],this.char="_",this.handleFocus=this.handleFocus.bind(this),this.handleKeyDown=this.handleKeyDown.bind(this),this.handleInput=this.handleInput.bind(this),this.charIndexes=this.template.split("").reduce((t,s,i)=>(s===this.char&&t.push(i),t),[]),this.reverseCharIndexes=[...this.charIndexes].reverse()}get nextCharIndex(){return this.charIndexes.find(t=>t>this.selectionStart)||this.reverseCharIndexes[0]+1}get previousCharIndex(){return this.reverseCharIndexes.find(t=>this.selectionStart>t)||this.charIndexes[0]}handleFocus(){const{input:t,template:s,char:i}=this;t.value=h(t.value,s,this.char),e(100).then(()=>{const s=t.value.indexOf(i),h=s>-1?s:t.value.length;this.input.setSelectionRange(h,h)})}handleKeyDown(t){this.template.indexOf(t.key)>-1&&t.preventDefault(),this.previousValue=t.target.value,this.selectionStart=t.target.selectionStart,this.selectionEnd=t.target.selectionEnd}handleInput(t){const{input:s,template:i,previousValue:e,previousCharIndex:o}=this;if("deleteContentBackward"===t.inputType){const t=n.escape(e.charAt(o)),r=e.replace(new RegExp(`${t}(?!.*${t})`),this.char);s.value=h(r,i,this.char),s.setSelectionRange(o,o)}else if("deleteContentForward"===t.inputType)s.value=h(s.value,i,this.char),s.setSelectionRange(this.selectionStart,this.selectionEnd);else{const t=this.nextCharIndex;s.value=h(s.value,i,this.char),s.setSelectionRange(t,t)}}componentWillLoad(){this.input=document.getElementById(this.for),this.input.addEventListener("focus",this.handleFocus),this.input.addEventListener("keydown",this.handleKeyDown),this.input.addEventListener("input",this.handleInput)}disconnectedCallback(){this.input.removeEventListener("focus",this.handleFocus),this.input.removeEventListener("keydown",this.handleKeyDown),this.input.removeEventListener("input",this.handleInput)}render(){return s("slot",null)}get host(){return i(this)}};export{o as ku4_mask}