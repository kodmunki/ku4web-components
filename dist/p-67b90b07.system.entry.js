var __spreadArray=this&&this.__spreadArray||function(t,e){for(var n=0,r=e.length,i=t.length;n<r;n++,i++)t[i]=e[n];return t};System.register(["./p-4de687d8.system.js","./p-0785fc39.system.js"],(function(t){"use strict";var e,n,r,i,a;return{setters:[function(t){e=t.r;n=t.h},function(t){r=t.a;i=t.Y;a=t.t}],execute:function(){var s=":host{display:none}";var u=t("ku4_mask",function(){function t(t){e(this,t);this.charIndexes=[];this.reverseCharIndexes=[];this.previousValue="";this.currentValue="";this.touchStart=false;this.template="";this.ban="";this.pattern="";this.char="_";this.hidden=false;this.handleFocus=this.handleFocus.bind(this);this.handleKeyDown=this.handleKeyDown.bind(this);this.handleInput=this.handleInput.bind(this);this.handleTouchStart=this.handleTouchStart.bind(this);this.init()}t.prototype.init=function(){var t=this;this.chars=this.char&&new RegExp(this.char);this.banned=this.ban&&new RegExp(this.ban);var e=this.pattern.replace(/[\s\n]/gm,"");this.patterns=e.substr(1).split(e[0]).map((function(t){try{return t&&new RegExp(t)||null}catch(e){}}));this.charIndexes=this.template.split("").reduce((function(e,n,r){if(t.chars.test(n)){e.push(r)}return e}),[]);this.reverseCharIndexes=__spreadArray([],this.charIndexes).reverse();return this};t.prototype.templateHandler=function(t,e){var n=this,i=n.input,a=n.previousCharIndex,s=n.previousValue,u=n.currentValue,h=n.value,o=n.char;var l=r.unmask(s,e,o).length;var c=r.unmask(u,e,o).length;var d=l<c?a+1:a;this.init().value=r.mask(r.unmask(h,e,o),t,o);i.setSelectionRange(d,d)};t.prototype.charHandler=function(t,e){var n=this,i=n.value,a=n.template;this.init().value=r.mask(r.unmask(i,a,e),a,t)};Object.defineProperty(t.prototype,"previousCharIndex",{get:function(){var t=this;return this.reverseCharIndexes.find((function(e){return t.selectionStart>e}))||this.charIndexes[0]},enumerable:false,configurable:true});Object.defineProperty(t.prototype,"value",{get:function(){return this.currentValue},set:function(t){var e=this,n=e.chars,r=e.hidden,i=e.input;var a=t.search(n);this.currentValue=t;i.value=r&&a>-1?t.substring(0,a):t},enumerable:false,configurable:true});t.prototype.handleTouchStart=function(){this.touchStart=true};t.prototype.handleFocus=function(){var t=this;if(window.document.documentMode){return}var e=this,n=e.input,a=e.template,s=e.char,u=e.chars,h=e.touchStart;this.value=r.mask(r.unmask(this.value,a,s),a,s);i(0).then((function(){var e=n.value.search(u);var r=e<0?n.value.length:e;t.input.setSelectionRange(e<0&&!h?0:r,r);t.touchStart=false}))};t.prototype.handleKeyDown=function(t){if(window.document.documentMode){return}var e=this,n=e.banned,i=e.hidden,a=e.template,s=e.char;if(t.key&&t.key.length===1&&n&&(n.test(t.key)&&!(t.altKey||t.ctrlKey||t.metaKey))){t.preventDefault()}this.previousValue=i?r.mask(r.unmask(t.target.value,a,s),a,s):t.target.value;this.selectionStart=t.target.selectionStart;this.selectionEnd=t.target.selectionEnd};t.prototype.handleInput=function(t){var e=this;if(window.document.documentMode){return}var n=this,i=n.input,s=n.template,u=n.char,h=n.chars,o=n.previousValue,l=n.banned,c=n.selectionStart,d=n.selectionEnd,v=n.previousCharIndex,f=n.patterns,p=n.charIndexes,g=n.reverseCharIndexes;if(!h.test(this.previousValue)&&t.inputType!=="insertFromPaste"&&t.inputType!=="deleteContentBackward"&&t.inputType!=="deleteContentForward"&&c===d){this.value=o;return}if(t.inputType==="insertFromPaste"){try{navigator.clipboard.readText().then((function(t){var n=t.replace(new RegExp(l,"g"),"");if(a.isNullOrEmpty(n)){e.value=o;i.setSelectionRange(c,c);return}if(!l||!l.test(n)){var v=o;if(c<d){var f=g.find((function(t){return t<=c-1}));var m=g.find((function(t){return t<=d-1}));var y=p.findIndex((function(t){return t===f}));var b=p.findIndex((function(t){return t===m}));var k=r.unmask(o,s,u);var x=k.substring(0,y+1)+k.substring(b+1,o.length);v=r.mask(x,s,u)}var S=p.find((function(t){return t>=c}));var I=p.findIndex((function(t){return t===S}));var w=r.unmask(v,s,u);v=w.substring(0,I)+n+w.substring(I,o.length);e.value=r.mask(v,s,u);var E=p[I+n.length]||e.value.search(h)||e.value.length;i.setSelectionRange(E,E)}}));this.value=o;i.setSelectionRange(c,c);return}catch(t){this.value=o;i.setSelectionRange(c,c);return}}if(t.inputType==="deleteContentBackward"){var m=g.find((function(t){return t<=c-1}));var y=g.find((function(t){return t<=d-1}));var b=p.findIndex((function(t){return t===m}));var k=p.findIndex((function(t){return t===y}));var x=r.unmask(o,s,u);if(b<k){var S=x.substring(0,b+1)+x.substring(k+1,o.length);this.value=r.mask(S,s,u);S&&b>-1?i.setSelectionRange(v+1,v+1):i.setSelectionRange(v,v)}else{var S=x.substring(0,b)+x.substring(k+1,o.length);this.value=r.mask(S,s,u);i.setSelectionRange(v,v)}return}if(t.inputType==="deleteContentForward"){var I=p.find((function(t){return t>=c}));var w=p.findIndex((function(t){return t===I}));var x=r.unmask(o,s,u);var S=x.substring(0,w)+x.substring(w+1,o.length);this.value=r.mask(S,s,u);i.setSelectionRange(c,c);return}if(t.altKey||t.ctrlKey||t.metaKey){return}if(!t.data){this.value=o;i.setSelectionRange(c,c);return}if(h.test(o.charAt(c))||c===s.length){var x=r.unmask(o,s,u);this.value=r.mask(x+t.data,s,u);var E=this.value.search(h);var R=E<0?s.length:E;i.setSelectionRange(R,R);var C=p.findIndex((function(t){return t>=R}));var T=C<0?p.length-1:C-1;this.validate(t.data,f[T])}else{var K=o;if(c<d){var L=g.find((function(t){return t<=c-1}));var V=g.find((function(t){return t<=d-1}));var b=p.findIndex((function(t){return t===L}));var k=p.findIndex((function(t){return t===V}));var F=r.unmask(o,s,u);var S=F.substring(0,b+1)+F.substring(k+1,o.length);K=r.mask(S,s,u)}var _=p.find((function(t){return t>=c}));var w=p.findIndex((function(t){return t===_}));var x=r.unmask(K,s,u);K=x.substring(0,w)+t.data+x.substring(w,o.length);var D=p.find((function(t){return t>_}));this.value=r.mask(K,s,u);i.setSelectionRange(D,D);var C=p.findIndex((function(t){return t>=D}));var T=C<0?p.length-1:C-1;this.validate(t.data,f[T])}};t.prototype.validate=function(t,e){var n=this,r=n.previousValue,i=n.input,s=n.value,u=n.selectionStart;if(a.exists(e)&&!(e.test(t)||/\(\?[!<=]/.test(e.toString())&&e.test(s))){this.value=r;i.setSelectionRange(u,u)}};t.prototype.componentWillLoad=function(){this.input=document.getElementById(this.for);if(a.exists(this.input)){this.input.addEventListener("focus",this.handleFocus);this.input.addEventListener("keydown",this.handleKeyDown);this.input.addEventListener("input",this.handleInput);this.input.addEventListener("touchstart",this.handleTouchStart)}else{console.error("ku4-mask must have a valid `for` referencing target field `id`.")}};t.prototype.disconnectedCallback=function(){if(this.input&&this.input.removeEventListener){this.input.removeEventListener("focus",this.handleFocus);this.input.removeEventListener("keydown",this.handleKeyDown);this.input.removeEventListener("input",this.handleInput);this.input.removeEventListener("touchstart",this.handleTouchStart)}};t.prototype.render=function(){return n("slot",null)};Object.defineProperty(t,"watchers",{get:function(){return{template:["templateHandler"],char:["charHandler"]}},enumerable:false,configurable:true});return t}());u.style=s}}}));