import{r as t,h as s}from"./p-80e7f1ae.js";import{u as i,c as h,Z as e}from"./p-ce48150b.js";const n=class{constructor(s){t(this,s),this.charIndexes=[],this.reverseCharIndexes=[],this.previousValue="",this.ban="",this.char="_",this.handleFocus=this.handleFocus.bind(this),this.handleKeyDown=this.handleKeyDown.bind(this),this.handleInput=this.handleInput.bind(this),this.charIndexes=this.template.split("").reduce((t,s,i)=>(s===this.char&&t.push(i),t),[]),this.reverseCharIndexes=[...this.charIndexes].reverse(),this.banned=this.ban&&new RegExp(this.ban)}get nextCharIndex(){return this.charIndexes.find(t=>t>this.selectionStart)||this.reverseCharIndexes[0]+1}get previousCharIndex(){return this.reverseCharIndexes.find(t=>this.selectionStart>t)||this.charIndexes[0]}handleFocus(){const{input:t,template:s,char:n}=this;t.value=i(h(t.value,s,n),s,this.char),e(0).then(()=>{const s=t.value.indexOf(n),i=s>-1?s:t.value.length;this.input.setSelectionRange(i,i)})}handleKeyDown(t){t.key&&1===t.key.length&&this.banned&&this.banned.test(t.key)&&t.preventDefault(),this.previousValue=t.target.value,this.selectionStart=t.target.selectionStart,this.selectionEnd=t.target.selectionEnd}handleInput(t){const{input:s,template:e,char:n,previousValue:o,previousCharIndex:r}=this;if("deleteContentBackward"===t.inputType){const t=h(o,e,n),a=t.substring(0,t.length-1)||"";s.value=i(a,e,n),s.setSelectionRange(r,r)}else if("deleteContentForward"===t.inputType){const t=h(o,e,n);s.value=i(t.substring(0,t.length-1),e,this.char),s.setSelectionRange(this.selectionStart,this.selectionEnd)}else{const r=this.nextCharIndex,a=h(o,e,n);s.value=i(a+t.data,e,this.char),s.setSelectionRange(r,r)}}componentWillLoad(){this.input=document.getElementById(this.for),this.input.addEventListener("focus",this.handleFocus),this.input.addEventListener("keydown",this.handleKeyDown),this.input.addEventListener("input",this.handleInput)}disconnectedCallback(){this.input.removeEventListener("focus",this.handleFocus),this.input.removeEventListener("keydown",this.handleKeyDown),this.input.removeEventListener("input",this.handleInput)}render(){return s("slot",null)}};n.style=":host{display:none}";export{n as ku4_mask}